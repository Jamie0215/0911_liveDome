<!DOCTYPE html>
<html>

<head>
  <title>ç« ç¯€æŒ‘æˆ°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="images/favicon.ico" rel="shortcut icon">
  <meta charset="UTF-8">
  <script src="/javascripts/vendor.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.0.2/vue.global.js"></script>
</head>

<body class="bg-lighter">
  <div class="container main my-5">
    <div class="row">
      <main class="col post">
        <!-- ç« ç¯€æ¨™é¡Œ -->
        <div class="mb-4">
          <h1 class="mt-0 text-muted">ç« ç¯€æŒ‘æˆ°</h1><small>æª”åï¼š<code>directive-final.html</code></small>
        </div>
        <!-- ğŸ”¥ğŸ”¥ç·´ç¿’é–‹å§‹ğŸ”¥ğŸ”¥ -->

        <div id="app">
          <div class="container gx-2">
            <div class="row gx-3 bg-light py-3">
              <div class="col-md-4">
                <div class="list-group">
                  <a href="javascript:;" class="list-group-item list-group-item-action"
                    :class="{'active':tempSelected.name === product.name}" v-for="product in products"
                    :key="product.name" @click="selectedProduct(product)">
                    <h6 class="card-title mb-1">{{product.name}}</h6>
                    <div class="d-flex align-items-center justify-content-between">
                      <p class="mb-0"><small>{{product.engName}}</small></p>
                      <p class="mb-0"><small>NT$ {{product.price}}</small></p>
                    </div>
                  </a>
                </div>
              </div>
              <div class="col-md-8">
                <div class="card mb-2">
                  <div v-if="!tempSelected.hasOwnProperty('name')"
                    class="position-absolute text-white d-flex align-items-center justify-content-center"
                    style="top: 0;bottom: 0;left: 0;right: 0;background-color: rgba(0, 0, 0, 0.65); z-index: 100;">
                    è«‹å…ˆé¸æ“‡é£²å“</div>
                  <div class="card-body px-4">
                    <div class="mb-3">
                      <label for="productNum" class="form-label">æ•¸é‡</label>
                      <input type="number" class="form-control" id="productNum" placeholder="æ•¸é‡" min="0"
                        v-model="tempSelected.mete">
                    </div>
                    <div class="mb-3">
                      <label for="productNum" class="form-label d-block">å†°å¡Š*</label>
                      <div class="form-check form-check-inline" v-for="(itemType,i) in iceType" :key="`ice_`+i">
                        <!--åˆ¤æ–· 1.tempSelectedæœ‰productså±¬æ€§  æˆ–æ˜¯ 2.å…©è€…éƒ½è¦æˆç«‹ => (A)å±¬æ€§å…§tempSelected.defaults.iceä¸æ˜¯ç©ºå­—ä¸² å’Œ (B)(iceã€iceType)æ¯”å°æ˜¯å¦åŒ¹é…,æœ‰åŒ¹é…æ™‚å–æ¶ˆdisabled-->
                        <input class="form-check-input" name="iceType" type="radio" :id="`ice_`+i" :value="itemType"
                          v-model="tempSelected.ice"
                          :disabled="!tempSelected.hasOwnProperty('defaults') ||ã€€(tempSelected.defaults.ice !== '' && tempSelected.defaults.ice !== itemType)">
                        <label class="form-check-label" :for="`ice_`+i">{{itemType}}</label>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="productNum" class="form-label d-block">ç”œåº¦*</label>
                      <div class="form-check form-check-inline" v-for="(itemSugar,i) in sugarType" :key="`sugar_`+i">
                        <input class="form-check-input" name="sugarType" type="radio" :id="`sugar_`+i"
                          :value="itemSugar" v-model="tempSelected.sweet"
                          :disabled="!tempSelected.hasOwnProperty('defaults') ||ã€€(tempSelected.defaults.sugar !== '' && tempSelected.defaults.sugar !== itemSugar)">
                        <label class="form-check-label" :for="`sugar_`+i">{{itemSugar}}</label>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="productNum" class="form-label d-block">åŠ æ–™(+10å…ƒ)</label>
                      <div class="form-check form-check-inline" v-for="(itemToppings,i) in toppingsType"
                        :key="`toppings_`+i">
                        <!--åˆ¤æ–· 1.tempSelectedæœ‰productså±¬æ€§  æˆ–æ˜¯ 2.indexOfé™£åˆ—æ¯”å°  tempSelected.defaults.toppings å°‹æ‰¾ itemToppings ç¬¦åˆ , ä¸æ˜¯-1è¡¨ç¤ºå¯ä»¥åŠ æ–™çš„ -->
                        <input class="form-check-input" type="checkbox" :id="`toppings_`+i" :value="itemToppings"
                          v-model="tempSelected.feed"
                          :disabled="!tempSelected.hasOwnProperty('defaults') ||ã€€tempSelected.defaults.toppings.indexOf(itemToppings) != -1">
                        <label class="form-check-label" :for="`toppings_`+i">{{itemToppings}}</label>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="productNotice" class="form-label">å‚™è¨»</label>
                      <textarea class="form-control" id="productNotice" rows="2"
                        v-model="tempSelected.speak"></textarea>
                    </div>
                    <div class="d-flex gap-2">
                      <button class="btn btn-outline-primary w-100" type="button" @click="reset">å–æ¶ˆ</button>
                      <button class="btn btn-primary w-100" type="button" @click="addToOrder()">åŠ å…¥</button>
                    </div>
                  </div>
                </div>
                <div class="card" v-if="addList.length > 0">
                  <div class="card-body">
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col">å“é …</th>
                          <th scope="col">å†°å¡Š</th>
                          <th scope="col">ç”œåº¦</th>
                          <th scope="col">åŠ æ–™</th>
                          <th scope="col">å–®åƒ¹</th>
                          <th scope="col">æ•¸é‡</th>
                          <th scope="col">å°è¨ˆ</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-for="(item,key) in addList" :key="'add' + key">
                          <!-- <th>X</th> -->
                          <th scope="row">{{item.name}}<br>
                            <small class="text-muted fw-normal">å‚™è¨»ï¼š{{item.speak}}</small>
                          </th>
                          <td>{{item.ice}}</td>
                          <td>{{item.sweet}}</td>
                          <td>{{item.feed.join()}}</td>
                          <td>{{item.price + item.feed.length*10}}</td>
                          <td>{{item.mete}}</td>
                          <td class="text-end">{{item.mete_price}}</td>
                        </tr>
                      </tbody>
                    </table>
                    <p class="text-end">å…± NT$ {{total}} å…ƒ</p>
                    <button class="btn btn-sm btn-secondary w-100" type="button" @click="order(addList)">ç”¢ç”Ÿè¨‚å–®</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-light p-3 mt-3" v-if="confirmOrder.length > 0">
            <div class="bg-white p-3 d-flex flex-column" style="min-height: 450px;">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">å“é …</th>
                    <th scope="col">å†°å¡Š</th>
                    <th scope="col">ç”œåº¦</th>
                    <th scope="col">åŠ æ–™</th>
                    <th scope="col">å–®åƒ¹</th>
                    <th scope="col">æ•¸é‡</th>
                    <th scope="col">å°è¨ˆ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(item,key) in confirmOrder" :key="'order' + key">
                    <th scope="row">{{item.name}}<br>
                      <small class="text-muted fw-normal">å‚™è¨»ï¼š{{item.speak}}</small>
                    </th>
                    <td>{{item.ice}}</td>
                    <td>{{item.sweet}}</td>
                    <td>{{item.feed.join()}}</td>
                    <td>{{item.price + item.feed.length*10}}</td>
                    <td>{{item.mete}}</td>
                    <td class="text-end">{{item.mete_price}}</td>
                  </tr>
                </tbody>
              </table>
              <p class="mt-3 mb-1">è¨‚å–®æˆç«‹æ™‚é–“ï¼š{{time}}</p>
              <p class="mb-1">é¤é»æ•¸ï¼š {{confirmOrder.length}}</p>
              <p class="mb-1">ä»˜æ¬¾ç‹€æ…‹ï¼šæœªä»˜æ¬¾</p>
              <p class="text-end mt-auto">å…± NT$ {{total}}å…ƒ</p>
            </div>
          </div>
        </div>

        <script>
          const App = {
            data() {
              return {
                time: 0,          //è¨‚å–®æ™‚é–“
                confirmOrder: [], //ç”¢ç”Ÿè¨‚å–®ç¢ºèª
                total: 0,         //ç¸½é‡‘é¡
                addList: [],      //åŠ å…¥å“é … 
                tempSelected: {},//é¸æ“‡å“é …
                iceType: ['æ­£å¸¸å†°', 'å°‘å†°', 'å¾®å†°', 'å»å†°', 'ç†±'],
                sugarType: ['å…¨ç³–', 'ä¸ƒåˆ†', 'åŠç³–', 'ä¸‰åˆ†', 'ç„¡ç³–'],
                toppingsType: ['çç ', 'ç²‰æ¢', 'å°ç²‰åœ“', 'æ¤°æœ', 'èŠ‹é ­'],
                products: [
                  {
                    name: 'çç é®®å¥¶èŒ¶',
                    engName: 'Pearl Milk Tea',
                    price: 60,
                    defaults: {
                      toppings: ['çç '],//ä¸èƒ½åŠ çš„
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'æ¤°æœé®®å¥¶èŒ¶',
                    engName: 'Coconut Milk Tea',
                    price: 60,
                    defaults: {
                      toppings: ['æ¤°æœ', 'ç²‰æ¢'], //ä¸èƒ½åŠ çš„
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'é®®å¥¶èŒ¶',
                    engName: 'Milk Tea',
                    price: 50,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'å¤æ„å†¬ç“œèŒ¶ (ç³–å›ºå®š)',
                    engName: 'Winter Melon Drink',
                    price: 30,
                    defaults: {
                      toppings: [''],
                      sugar: 'å…¨ç³–', //åªæœ‰
                      ice: '',
                    }
                  },
                  {
                    name: 'èœœé¦™ç´…èŒ¶',
                    engName: 'Black Tea',
                    price: 30,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'åŒ…ç¨®é’èŒ¶',
                    engName: 'Black Tea',
                    price: 35,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'æª¸æª¬çƒé¾',
                    engName: 'Lemon Oolong Tea',
                    price: 55,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'è–‘æ¯èŒ¶ (ç†±é£²)',
                    engName: 'Ginger Tea',
                    price: 55,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: 'ç†±',
                    }
                  },
                  {
                    name: 'é’è‰èŒ¶',
                    engName: 'Herbal Tea',
                    price: 35,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'é‡‘æ¡”æª¸æª¬',
                    engName: 'Kumquat Lemonade',
                    price: 40,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                  {
                    name: 'æŸ³æ¾„é’èŒ¶',
                    engName: 'Orange Mountain Tea',
                    price: 45,
                    defaults: {
                      toppings: [''],
                      sugar: '',
                      ice: '',
                    }
                  },
                ],
              }
            },
            //æ–¹æ³• è§¸ç™¼ (ç‰©ä»¶)
            methods: {
              reset() {//æ¸…ç©º
                this.tempSelected = {};
              },
              //é¸æ“‡å“é …
              selectedProduct(obj) {
                //è‡ªè¨‚åƒæ•¸
                this.tempSelected = {
                  mete: 1,    //æ•¸é‡
                  ice: obj.defaults.ice !== '' ? obj.defaults.ice : 'æ­£å¸¸å†°',      //å†°å¡Š
                  sweet: obj.defaults.sugar !== '' ? obj.defaults.sugar : 'å…¨ç³–', //ç”œåº¦
                  feed: [],     //åŠ æ–™                 
                  speak: '',    //å‚™è¨»
                  mete_price: 0,//æ•¸é‡*ä¸€æ¯é‡‘é¡ = ç¸½é‡‘é¡
                  ...obj
                }
              },
              //åŠ å…¥å“é …  
              addToOrder() {
                //æ–¹æ³•ä¸€ (è€å¸«) è¨˜å¾—åŠ ä¸Š => addToOrder(product)
                //  this.addList.push(Object.assign(product, { 
                //   mete_price: (product.price + product.feed.length * 10) * product.mete}));

                //æ–¹æ³•äºŒ (è‡ªå·±) => ç¨å¾®ç¬¨ä¸€é»çš„æ–¹å¼
                let Total = 0;
                this.addList.push(this.tempSelected);                       
                this.addList.forEach((item) => {
                  item.mete_price = (item.price + item.feed.length * 10) * item.mete;//æ•¸é‡*ä¸€æ¯é‡‘é¡=ç¸½é‡‘é¡
                  Total += item.mete_price;
                });
                this.total = Total;
                this.reset();
              },
              //ç”¢ç”Ÿè¨‚å–®
              order(all) {
                const date = new Date().toLocaleString();
                this.time = date;
                this.addList = [];
                this.confirmOrder = all;
              }
            },
            //ç”Ÿå‘½é€±æœŸ å…ˆåˆå§‹åŒ–
            // created() {
            //   this.reset();
            //   // console.log(this.tempSelected)
            // }
          };

          Vue.createApp(App).mount('#app');
        </script>
        <!-- ğŸ™‡ğŸ™‡ç·´ç¿’çµæŸğŸ™‡ğŸ™‡ -->
      </main>

      <aside class="col-md-3">
        <div class="sticky-top" style="top: 76px">
          <div class="list-group">

            <a href="/template/v-text.html" class="list-group-item list-group-item-action
        list-group-item-success
        ">
              æ¸²æŸ“è³‡æ–™æ–¼ç•«é¢ä¸Š
            </a>

            <a href="/template/v-for.html" class="list-group-item list-group-item-action
        list-group-item-success
        ">
              å‘ˆç¾å¤šç­†è³‡æ–™
            </a>

            <a href="/template/v-if.html" class="list-group-item list-group-item-action
        list-group-item-success
        ">
              æ¸²æŸ“åˆ¤æ–·
            </a>

            <a href="/template/v-bind.html" class="list-group-item list-group-item-action
        list-group-item-success
        ">
              å±¬æ€§ç¶å®š
            </a>

            <a href="/template/v-style.html" class="list-group-item list-group-item-action
        list-group-item-success
        ">
              æ¨£å¼åˆ‡æ›
            </a>

            <a href="/template/form.html" class="list-group-item list-group-item-action
        list-group-item-danger
        ">
              v-model èˆ‡è¡¨å–®
            </a>

            <a href="/template/v-model-modifiers.html" class="list-group-item list-group-item-action
        list-group-item-danger
        ">
              v-model ä¿®é£¾ç¬¦
            </a>

            <a href="/template/v-on.html" class="list-group-item list-group-item-action
        list-group-item-info
        ">
              v-on äº‹ä»¶è§¸ç™¼
            </a>

            <a href="/template/v-on-modifiers.html" class="list-group-item list-group-item-action
        list-group-item-info
        ">
              v-on ä¿®é£¾ç¬¦
            </a>

            <a href="/template/v-on-dom-event.html" class="list-group-item list-group-item-action
        list-group-item-info
        ">
              è£œå……ï¼šv-on DOM äº‹ä»¶
            </a>

            <a href="/template/directive-final.html" class="list-group-item list-group-item-action
        
        active">
              ç« ç¯€æŒ‘æˆ°
            </a>

          </div>
          <div class="mt-3 text-end p-2 bg-light rounded">
            <small class="text-black-50 fw-light mb-0">æ–‡ä»¶ç‰ˆæœ¬ï¼š2021/6/29</small>
          </div>
        </div>

      </aside>

    </div>
  </div>

  <nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-secondary">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">Vue 3 ç·´ç¿’æ‰‹å†Š</a>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link " href="/es6/shorthand.html">JS å¿…å‚™è§€å¿µ</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/intro/createApp.html">èªè­˜ Vue.js</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/template/v-text.html">æ¨¡æ¿</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/optionsApi/options-methods.html">æ–¹æ³•</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/components/component_register.html">å…ƒä»¶</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/advApi/adv-refs.html">é€²éš</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/router/vue-router.html">è·¯ç”±</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/composition/proxy.html">Composition API</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <footer class="footer py-2 bg-light">
    <div class="container text-center">
      <small class="text-black-50 fw-light mb-0">å…­è§’å­¸é™¢ Vue èª²ç¨‹å°ˆå±¬æ–‡ä»¶</small>
    </div>
  </footer>
  <link rel="stylesheet" href="/stylesheets/all.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</body>
</html>
